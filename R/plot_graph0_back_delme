#' plot weighted graph
#'
#' @description
#' From a dataframe of graph frequence, plot a graph plot a graph of
#' co-occurrence of terms, as returned by get_cooc_entities, extract_graph
#'
#' @param text an input text
#' @param DF a dataframe of co-occurrence, extracted with `extract_graph()` and
#' `count(n1, n2)`
#' @param head_n number of nodes to show - the more frequent
#' @param edge_color color of the edges
#' @param edge_alpha transparency of the edges. Values between 0 and 1.
#' @param node_alpha transparency of the nodes
#' @param text_color color of the text in nodes
#' @param text_size font size of the nodes
#' @param scale_graph name of a function to normalize the result. Sometime, the range
#' of numbers are so wide that the graph becomes unreadable. Applying a function
#' to normalize the result can improve the readability, for example using
# `scale_graph = "log2"`, or `"log10"`
#'
#' @export
#'
#' @examples
#' # plot_graph(DF = graph_count, head_n = 50, scale_graph = "log2")
plot_graph0 <- function(
    DF,
    head_n = 30,
    edge_color = "lightblue",
    edge_alpha = 0.5,
    node_alpha = 0.5,
    text_color = "black",
    text_size = 1
    # scale_graph = "scale_values"
    ) {
  # to head or not to head
  if (head_n == "") {
    graph <- DF
  } else {
    graph <- DF |> head(head_n)
  }

  graph |>
    tidygraph::as_tbl_graph() |>
    ggraph::ggraph(layout = "graphopt") +
    ggraph::geom_edge_link(
      ggplot2::aes(
        edge_width = 1
      ),
      colour = edge_color,
      edge_alpha = edge_alpha,
      angle_calc = c("along", "rot")[1],
      label_dodge = grid::unit(4.5, "mm"),
      end_cap = ggraph::circle(6, "mm")
    ) + # afastamento do n√≥
    ggraph::geom_node_point(
      ggplot2::aes(
        # normalizando o tamanho do texto
        # size = eval(dplyr::sym(scale_graph))(freqPPN$freq)
      ),
      # colour = node_color,
      colour = edge_color,
      alpha = node_alpha,
      # repel = TRUE
    ) +
    ggraph::geom_node_text(
      ggplot2::aes(
        label = name,
        # fill = text_color,
      ),
      colour = text_color,
      size = text_size,
      # repel = TRUE
    ) +
    # ggraph::geom_node_label(ggplot2::aes(label = name), repel=TRUE,  point.padding = unit(0.2, "lines")) +
    ggplot2::theme_void() +
    ggplot2::theme(legend.position = "none")
}
