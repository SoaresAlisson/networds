<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>01 - Entity extraction with regex • networds</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="01 - Entity extraction with regex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">networds</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/02-Extract-entity-co-ocurrences-with-POS.html">02-Extract entity co-ocurrences with POS</a></li>
    <li><a class="dropdown-item" href="../articles/entities_and_relation_extraction.html">01 - Entity extraction with regex</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SoaresAlisson/networds/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="entities_and_relation_extraction_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="entities_and_relation_extraction_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="entities_and_relation_extraction_files/d3-4.9.1/d3.min.js"></script><script src="entities_and_relation_extraction_files/forceNetwork-binding-0.4.1/forceNetwork.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>01 - Entity extraction with regex</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SoaresAlisson/networds/blob/HEAD/vignettes/entities_and_relation_extraction.Rmd" class="external-link"><code>vignettes/entities_and_relation_extraction.Rmd</code></a></small>
      <div class="d-none name"><code>entities_and_relation_extraction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="entity-extraction-and-its-relations">Entity extraction and its relations<a class="anchor" aria-label="anchor" href="#entity-extraction-and-its-relations"></a>
</h2>
<p>The package {networds} provides a set of tools to extract entities
and relations from text. The first of this tools uses one of the simples
form: by using the rule based approach. It contains a rule based
extraction algorithm and a rule based relation extraction algorithm.
<!-- For more advanced NER, there is other packages such as  -->
<!-- [{crfsuite}](https://cran.r-project.org/web/packages/crfsuite/index.html), {[UDpipe](https://cran.r-project.org/web/packages/udpipe/)} and {[spacyR](https://spacyr.quanteda.io/)}. -->
Another similar package is <a href="https://github.com/cbail/textnets" class="external-link">textnets</a>, from Chris Bail.
It capture the proper names using UDpipe, plot word networks and
calculates the centrality/betweeness of words in the network. To extract
entities based on Part of speech tagging, see other functions of this
package,</p>
<!-- Carley 1993, MAP analysis -->
<p>The functions of {networds} do not work so well like the NER, but we
think that, in some situations, they can be better job than traditional
joining unigram, bigrams, trigrams and so on. Because it is a rule based
approach, it is very simple to use, need less dependencies and runs also
fast (or maybe less slower). It will also requires a lot of
post-cleaning, but you have the absolute control over which words are
extracted and what words are rejected.</p>
<p>In Natural Language Processing, to find proper names or terms that
frequently appears together is called “collocation”, e.g., to find
“United Kingdom”. You can learn more what is collocation and its
statistical details and r function in this <a href="https://sigil.r-forge.r-project.org/materials/04_collocation_analysis.pdf" class="external-link">article</a>,
and it is also possible to functions like <a href="https://quanteda.io/reference/textstat_collocations.html" class="external-link"><code>quanteda.textstats::textstat_collocations()</code></a>,
<a href="https://cran.r-project.org/web/packages/TextForecast/" class="external-link"><code>TextForecast::get_collocations()</code></a>
to identify them, but it also will require a lot of data cleaning,
specially if you want is proper names.</p>
</div>
<div class="section level2">
<h2 id="how-it-works">How it works?<a class="anchor" aria-label="anchor" href="#how-it-works"></a>
</h2>
<p>The function captures all words that:</p>
<ul>
<li>begins with uppercase,<br>
</li>
<li>followed by other uppercases, lowercase or numbers, without white
space<br>
</li>
<li>it can contain symbols like <code>_</code>, <code>-</code> or
<code>.</code>. In this way, words like “Covid-19” are captured.</li>
<li>the user can specify a connector, like “of”or “of the” so, words
like “United States of America” are also captured</li>
</ul>
<p>In languages such as English and Portuguese, it extracts proper
names. In German, it also extracts nouns. There is some trade-off, of
course. It will capture a lot of undesired words and will demand
posterior cleaning, like:<br>
- It does not contain any sort of built-in classification.<br>
- “Obama Chief of Staff Rahm Emanuel” will be captured as one entity,
what is not wrong et al, but maybe not what was expect.</p>
</div>
<div class="section level2">
<h2 id="the-downsides">The downsides<a class="anchor" aria-label="anchor" href="#the-downsides"></a>
</h2>
<p>It will not capture:</p>
<ul>
<li>entities that begin with lowercase.
<!-- To do that, take a look at other already mentioned packages, like spacyr and UDpipe. -->
</li>
<li>it does not delves with words ambiguity. For example, is “WHO”
referring to question or World Health Organization? Washington is a
person or a place?</li>
</ul>
<p>To overthrow this problemas, networds has a set of other functions
that works with Part of Speech tagging and Named Entity Recognition. If
the problems enumerated are a big problem to your case, take a look at
the next session “Extract entity co-ocurrences with POS”.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In my experience, the approach of this section using regex works
better to certain types of text than others. Very well formatted text,
like Books, formal articles can be a good option that works well with
this function. Text from social media, because it lacks formalities of
the language and have a lot of typos, lacking uppercase sometimes, or
written all in uppercase, this approach will not work so well.</p>
</div>
<div class="section level2">
<h2 id="using-networds-extracting-entities-with-regex">Using networds: extracting entities with regex<a class="anchor" aria-label="anchor" href="#using-networds-extracting-entities-with-regex"></a>
</h2>
<p>After installing the package (see Readme), load it:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SoaresAlisson/networds" class="external-link">networds</a></span><span class="op">)</span></span></code></pre></div>
<p>So, let’s extract some proper names from a simple text:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="st">"John Does lives in New York in United States of America."</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/extract_entity.html">extract_entity</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "John Does"                "New York"                </span></span>
<span><span class="co">#&gt; [3] "United States of America"</span></span></code></pre></div>
<p>Or it is possible to use other languages, specifying the parameter
<code>connectors</code> using the function
<code>connectors(lang)</code>. Checking the connectors:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/connectors.html">connectors</a></span><span class="op">(</span><span class="st">"eng"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "of"     "of the"</span></span>
<span><span class="co"># or you can also use for english, to get the same result:</span></span>
<span><span class="fu"><a href="../reference/connectors.html">connectors</a></span><span class="op">(</span><span class="st">"en"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "of"     "of the"</span></span>
<span><span class="co"># For portuguese</span></span>
<span><span class="fu"><a href="../reference/connectors.html">connectors</a></span><span class="op">(</span><span class="st">"pt"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "da"  "das" "de"  "do"  "dos"</span></span>
<span><span class="co"># to get the same result:</span></span>
<span><span class="fu"><a href="../reference/connectors.html">connectors</a></span><span class="op">(</span><span class="st">"port"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "da"  "das" "de"  "do"  "dos"</span></span>
<span></span>
<span><span class="co"># by default, the functions uses the parameter "misc". meaning "miscellaneous".</span></span>
<span><span class="fu"><a href="../reference/connectors.html">connectors</a></span><span class="op">(</span><span class="st">"misc"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "of"     "the"    "of the" "von"    "van"    "del"</span></span></code></pre></div>
<p>Using with other languages: suppressWarnings(</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="st">"João Ninguém mora em São José do Rio Preto. Ele esteve antes em Sergipe"</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/extract_entity.html">extract_entity</a></span><span class="op">(</span>connect <span class="op">=</span> <span class="fu"><a href="../reference/connectors.html">connectors</a></span><span class="op">(</span><span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "João Ninguém"          "São José do Rio Preto" "Ele"                  </span></span>
<span><span class="co">#&gt; [4] "Sergipe"</span></span>
<span></span>
<span><span class="va">vonNeumann_txt</span> <span class="op">&lt;-</span> <span class="st">"John von Neumann (/vɒn ˈnɔɪmən/ von NOY-mən; Hungarian: Neumann János Lajos [ˈnɒjmɒn ˈjaːnoʃ ˈlɒjoʃ]; December 28, 1903 – February 8, 1957) was a Hungarian and American mathematician, physicist, computer scientist and engineer"</span></span>
<span><span class="va">vonNeumann_txt</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/extract_entity.html">extract_entity</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "John von Neumann"    "NOY-"                "Hungarian"          </span></span>
<span><span class="co">#&gt; [4] "Neumann János Lajos" "December"            "February"           </span></span>
<span><span class="co">#&gt; [7] "Hungarian"           "American"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extracting-a-graph">Extracting a graph<a class="anchor" aria-label="anchor" href="#extracting-a-graph"></a>
</h2>
<p>It is possible to extract a graph from the extracted entities. First,
happens the tokenization by sentence or paragraph. Than, the entities
are extracted using <code><a href="../reference/extract_entity.html">extract_entity()</a></code>. Than a data frame
with the co-occurrence of words in sentences or paragraph is build.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vonNeumann_txt</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/extract_graph.html">extract_graph</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tokenizing by sentences</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 27 × 2</span></span></span>
<span><span class="co">#&gt;    n1               n2                 </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> John von Neumann NOY-               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> John von Neumann Hungarian          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> John von Neumann Neumann János Lajos</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> John von Neumann December           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> John von Neumann February           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> John von Neumann Hungarian          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> John von Neumann American           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> NOY-             Hungarian          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> NOY-             Neumann János Lajos</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> NOY-             December           </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 17 more rows</span></span></span></code></pre></div>
<p>One of the parameters is <code>sw</code> that means “stopwords”. It
is possible to add a vector stopwords.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_sw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">stopwords</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stopwords/man/stopwords.html" class="external-link">stopwords</a></span><span class="op">(</span></span>
<span>  language <span class="op">=</span> <span class="st">"en"</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"snowball"</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span>, <span class="st">"lol"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vonNeumann_txt</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/extract_graph.html">extract_graph</a></span><span class="op">(</span>sw <span class="op">=</span> <span class="va">my_sw</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tokenizing by sentences</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 27 × 2</span></span></span>
<span><span class="co">#&gt;    n1               n2                 </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> John von Neumann NOY-               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> John von Neumann Hungarian          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> John von Neumann Neumann János Lajos</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> John von Neumann December           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> John von Neumann February           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> John von Neumann Hungarian          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> John von Neumann American           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> NOY-             Hungarian          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> NOY-             Neumann János Lajos</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> NOY-             December           </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 17 more rows</span></span></span></code></pre></div>
<p>This process can take a while to run if the text/corpus is big. So,
if you are interested only in some words, so first of all, filter the
sentences/paragraphs with the desired words, and after that, extract the
graph. Seeing another example, extracting from a Wikipedia article:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">page</span> <span class="op">&lt;-</span> <span class="st">"https://en.wikipedia.org/wiki/GNU_General_Public_License"</span> <span class="op">|&gt;</span> <span class="fu">rvest</span><span class="fu">::</span><span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html" class="external-link">read_html</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">text</span> <span class="op">&lt;-</span> <span class="va">page</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rvest</span><span class="fu">::</span><span class="fu"><a href="https://rvest.tidyverse.org/reference/rename.html" class="external-link">html_nodes</a></span><span class="op">(</span><span class="st">"p"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rvest</span><span class="fu">::</span><span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html" class="external-link">html_text</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># looking at the scraped text:</span></span>
<span><span class="va">text</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="co"># seeing the head of the text</span></span>
<span><span class="co">#&gt; [1] "\n\n"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         </span></span>
<span><span class="co">#&gt; [2] "The GNU General Public Licenses (GNU GPL or simply GPL) are a series of widely used free software licenses, or copyleft licenses, that guarantee end users the freedoms to run, study, share, and modify the software.[7] The GPL was the first copyleft license for general use. It was originally written by Richard Stallman, the founder of the Free Software Foundation (FSF), for the GNU Project. The license grants the recipients of a computer program the rights of the Free Software Definition.[8] The licenses in the GPL series are all copyleft licenses, which means that any derivative work must be distributed under the same or equivalent license terms. It is more restrictive than the Lesser General Public License and even further distinct from the more widely-used permissive software licenses such as BSD, MIT, and Apache.\n"</span></span></code></pre></div>
<p>And now extracting the graphs:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="va">text</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/extract_graph.html">extract_graph</a></span><span class="op">(</span>sw <span class="op">=</span> <span class="va">my_sw</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tokenizing by sentences</span></span>
<span><span class="va">g</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,239 × 2</span></span></span>
<span><span class="co">#&gt;    n1                              n2                           </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> The GNU General Public Licenses GNU GPL                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> The GNU General Public Licenses GPL                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> The GNU General Public Licenses The GPL                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> The GNU General Public Licenses Richard Stallman             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> The GNU General Public Licenses Free Software Foundation     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> The GNU General Public Licenses FSF                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> The GNU General Public Licenses GNU Project                  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> The GNU General Public Licenses Free Software Definition     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> The GNU General Public Licenses GPL                          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> The GNU General Public Licenses Lesser General Public License</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3,229 more rows</span></span></span>
<span><span class="va">g_N</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span>, sort <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">g_N</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,100 × 3</span></span></span>
<span><span class="co">#&gt;    n1           n2              n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> GPLv3        GPLv2          24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Artifex      Hancom         19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Ghostscript  Hancom         19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Linux        GPL            16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> GPL          FSF            14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> GPL-licensed GPL            14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> GPL          GPLv3          13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Artifex      Ghostscript    12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> However      GPL            12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> FSF          GPL            11</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,090 more rows</span></span></span></code></pre></div>
<p>To plot the wordcloud network it is necessary two parameters: the
original text and the dataframe/tibble as returned by
<code><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">dplyr::count()</a></code>, with three columns: node 1, node 2 and the
weight/frequency.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/net_wordcloud.html">net_wordcloud</a></span><span class="op">(</span><span class="va">text</span>, <span class="va">g_N</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `n`.</span></span></code></pre></div>
<p><img src="entities_and_relation_extraction_files/figure-html/ploting%20the%20graph-1.png" width="750"></p>
<p>There are different information in the graph:</p>
<ul>
<li>The size of words and compound words means the individual frequency
of each word/compound word</li>
<li>The thickness of the links indicates how often the pair occur
together.</li>
</ul>
<p>We opted to use this approach of the two parameters of data frame
with weights, as well as with the original text because plotting such
networks as a matter of readability, often requires to select only the
most frequent. A word individual frequency is not necessarily correlated
with it’s frequency in graphs, so the function calculates the individual
frequency of the word. Looking at the frequency dataframe, the user may
want to strip some graphs, and then plot it.</p>
<p>This function uses {<a href="https://ggraph.data-imaginist.com/reference/" class="external-link">ggraph</a>} and
ggplot. So, you can change some ggplot or add another ones <em>a
posteriori</em>.</p>
<p>To plot an interactive graph, it is possible to use {<a href="https://christophergandrud.github.io/networkD3/" class="external-link">networkD3</a>}:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g_N</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># to reduce the amount of nodes and edges in the graph</span></span>
<span>  <span class="fu">networkD3</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/networkD3/man/simpleNetwork.html" class="external-link">simpleNetwork</a></span><span class="op">(</span></span>
<span>    height <span class="op">=</span> <span class="st">"10px"</span>, width <span class="op">=</span> <span class="st">"30px"</span>,</span>
<span>    linkDistance <span class="op">=</span> <span class="fl">50</span>,</span>
<span>    fontSize <span class="op">=</span> <span class="fl">16</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="forceNetwork html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:750px;height:450px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"links":{"source":[36,9,27,45,32,34,32,9,38,24,32,32,37,57,26,32,35,36,32,32,36,43,11,32,32,27,45,50,55,32,32,32,45,46,54,6,10,21,32,35,36,39,48,0,12,13,14,20,24,29,32,32,35,35,35,35,36,27,27,37,37,37,42,44,46,47,52,2,4,5,9,9,9,9,11,15,13,16,24,17,21,21,22,30,30,32,32,32,32,32,32,32,32,32,32,32,34,34,34,35],"target":[35,37,37,32,24,32,36,27,32,32,35,41,27,32,32,26,36,32,45,55,45,24,24,10,34,9,36,32,32,28,33,50,34,32,61,35,32,24,21,45,24,32,42,37,32,32,32,32,36,35,23,38,31,51,53,58,52,32,40,9,32,40,48,36,34,32,32,61,36,36,18,32,40,60,43,34,34,32,26,34,32,36,34,26,32,1,3,19,20,25,42,48,49,54,56,57,7,8,59,24],"value":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"colour":["#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666"]},"nodes":{"name":["AGPL License","Also","Although the FSF","Ambiguity","Andrew Morton","Apache","Apache License","Apple","Apple DRM","Artifex","Black Duck Software","Cisco","Copyleft","Debian","Different","DRM-restricted","Eric","Fedora","First","FLOSS Manuals","FOSS","Free Software Foundation","FreeBSD","Freecode","FSF","German","GFDL","Ghostscript","GNU","GNU Affero General Public License","GNU Free Documentation License","GNU Project","GPL","GPL FAQ","GPL-licensed","GPLv2","GPLv3","Hancom","However","In August","Judge Jacqueline Scott Corley","LGPL","License","Linksys","Linus Torvalds","Linux","Microsoft","Mundie","Program","Raymond","Richard Stallman","Rob Landley","Similarly","Software","Stallman","The FSF","The GNU Lesser General Public License","The GPL","Toybox","Ubuntu","US District Court","X11"],"group":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"nodesize":[8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]},"options":{"NodeID":"name","Group":"group","colourScale":"d3.scaleOrdinal(['#3182bd'])","fontSize":16,"fontFamily":"serif","clickTextSize":40,"linkDistance":50,"linkWidth":"'1.5px'.toString()","charge":-30,"opacity":0.6,"zoom":false,"legend":false,"arrows":false,"nodesize":true,"radiusCalculation":"d.nodesize","bounded":false,"opacityNoHover":1,"clickAction":null}},"evals":[],"jsHooks":[]}</script><!-- g_N |> interactive_graph() --><p>Another text example.
<!-- "https://en.wikipedia.org/wiki/Julia_Silge" --></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">page</span> <span class="op">&lt;-</span> <span class="st">"https://en.wikipedia.org/wiki/Hurricane_Milton"</span> <span class="op">|&gt;</span> <span class="fu">rvest</span><span class="fu">::</span><span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html" class="external-link">read_html</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">text</span> <span class="op">&lt;-</span> <span class="va">page</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rvest</span><span class="fu">::</span><span class="fu"><a href="https://rvest.tidyverse.org/reference/rename.html" class="external-link">html_nodes</a></span><span class="op">(</span><span class="st">"p"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rvest</span><span class="fu">::</span><span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html" class="external-link">html_text</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">text</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="co"># seeing the head of the tex</span></span>
<span><span class="co">#&gt; [1] "\n\n\n"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </span></span>
<span><span class="co">#&gt; [2] "Hurricane Milton was an extremely powerful and destructive tropical cyclone which became the second-most intense Atlantic hurricane ever recorded over the Gulf of Mexico, behind only Hurricane Rita in 2005. Milton made landfall on the west coast of the U.S. state of Florida, less than two weeks after Hurricane Helene devastated the state's Big Bend region.[2] The thirteenth named storm, ninth hurricane, fourth major hurricane, and second Category 5 hurricane of the 2024 Atlantic hurricane season, Milton is the strongest tropical cyclone to occur worldwide in 2024 thus far.[3]"</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="va">text</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/extract_graph.html">extract_graph</a></span><span class="op">(</span>sw <span class="op">=</span> <span class="va">my_sw</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tokenizing by sentences</span></span>
<span><span class="co"># option 1: use counting the edge frequency</span></span>
<span><span class="va">g_N</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span>, sort <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co"># option 2: use count_graphs function, same results, but using data.table (quicker) and erasing loops</span></span>
<span><span class="va">g_N</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/count_graphs.html">count_graphs</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/net_wordcloud.html">net_wordcloud</a></span><span class="op">(</span><span class="va">text</span>, <span class="va">g_N</span>, head_n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `n`.</span></span></code></pre></div>
<p><img src="entities_and_relation_extraction_files/figure-html/ex2%20wiki%20Hurricane2-1.png" width="750"></p>
<p>To plot an interactive graph, it is possible to use {networkD3}:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g_N</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># to reduce the amount of nodes and edges in the graph</span></span>
<span>  <span class="fu">networkD3</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/networkD3/man/simpleNetwork.html" class="external-link">simpleNetwork</a></span><span class="op">(</span></span>
<span>    height <span class="op">=</span> <span class="st">"10px"</span>, width <span class="op">=</span> <span class="st">"30px"</span>,</span>
<span>    linkDistance <span class="op">=</span> <span class="fl">50</span>,</span>
<span>    fontSize <span class="op">=</span> <span class="fl">16</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="forceNetwork html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:750px;height:450px;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"links":{"source":[32,10,35,32,35,10,14,14,35,47,32,32,32,32,35,35,10,10,32,47,10,10,32,32,35,35,35,2,6,6,10,13,14,18,35,42,43,47,9,10,13,18,32,32,35,35,47,47,47,3,9,13,13,13,20,23,24,27,31,32,32,34,35,35,35,36,39,41,43,0,3,4,5,6,9,10,10,10,11,12,13,13,14,14,14,17,17,21,25,25,28,32,32,33,35,35,35,35,37,38],"target":[35,35,32,10,10,32,35,32,14,35,47,3,14,48,7,36,7,47,51,32,4,14,4,7,3,4,47,35,32,35,41,14,10,35,41,35,38,10,35,3,50,0,19,41,48,51,3,48,51,32,32,26,32,34,32,32,32,35,35,22,46,13,8,18,45,35,30,35,21,35,10,35,35,10,10,1,48,51,32,35,15,16,36,40,45,10,35,32,32,35,10,30,39,32,0,29,44,49,32,21],"value":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"colour":["#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666"]},"nodes":{"name":["Abaco","Afterwards","Amtrak","Atlantic","Atlantic Ocean","Auto Train","Bay of Campeche","Bermuda","Busch Gardens Tampa Bay","Caribbean Sea","Category","Celestún","Extreme Northwest Bahamian Islands","FEMA","Florida","Florida Attorney General Ashley Moody","Following","Gradual","Grand Bahama","Gulf of Mexico","Heavy","Hillsborough County","Hurricane Felix","Hurricane Helene","Hurricane Hunters","Hurricane Milton","Hurricanes Helene","Jacksonville","Later","Legoland Florida","Mexican Navy","Miami","Milton","NHC","November","October","Orlando","Overnight","Petersburg","Progreso","Several","Siesta Key","Silver Service","St","Starting","Tampa","USD","UTC","UTC October","Walt Disney World","Washington","Wilma"],"group":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"nodesize":[8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]},"options":{"NodeID":"name","Group":"group","colourScale":"d3.scaleOrdinal(['#3182bd'])","fontSize":16,"fontFamily":"serif","clickTextSize":40,"linkDistance":50,"linkWidth":"'1.5px'.toString()","charge":-30,"opacity":0.6,"zoom":false,"legend":false,"arrows":false,"nodesize":true,"radiusCalculation":"d.nodesize","bounded":false,"opacityNoHover":1,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="using-state-of-the-union-data">Using State of the Union data<a class="anchor" aria-label="anchor" href="#using-state-of-the-union-data"></a>
</h2>
<p>Using the package <a href="https://github.com/taylor-arnold/sotu" class="external-link">SOTU</a>, that contains the
<a href="https://en.wikipedia.org/wiki/State_of_the_Union" class="external-link">State of the
Union Addresses</a>. It :</p>
<pre><code><span><span class="st">"is an annual message delivered by the president of the United States to a joint session of the United States Congress near the beginning of most calendar years on the current condition of the nation. The speech generally includes reports on the nation's budget, economy, news, agenda, progress, achievements and the president's priorities and legislative proposals."</span> </span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/statsmaths/sotu/" class="external-link">sotu</a></span><span class="op">)</span> <span class="co">#  text examples of US presidents speeches</span></span>
<span></span>
<span><span class="co"># checking the DF with the speeches</span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">sotu_meta</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 240 × 6</span></span></span>
<span><span class="co">#&gt;        X president          year years_active party       sotu_type</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 George Washington  <span style="text-decoration: underline;">1</span>790 1789-1793    Nonpartisan speech   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2 George Washington  <span style="text-decoration: underline;">1</span>790 1789-1793    Nonpartisan speech   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3 George Washington  <span style="text-decoration: underline;">1</span>791 1789-1793    Nonpartisan speech   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4 George Washington  <span style="text-decoration: underline;">1</span>792 1789-1793    Nonpartisan speech   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5 George Washington  <span style="text-decoration: underline;">1</span>793 1793-1797    Nonpartisan speech   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6 George Washington  <span style="text-decoration: underline;">1</span>794 1793-1797    Nonpartisan speech   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7 George Washington  <span style="text-decoration: underline;">1</span>795 1793-1797    Nonpartisan speech   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8 George Washington  <span style="text-decoration: underline;">1</span>796 1793-1797    Nonpartisan speech   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9 John Adams         <span style="text-decoration: underline;">1</span>797 1797-1801    Federalist  speech   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10 John Adams         <span style="text-decoration: underline;">1</span>798 1797-1801    Federalist  speech   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 230 more rows</span></span></span></code></pre></div>
<p>Checking Obama speech of the first year of his first mandate</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># checking what are the speeches of Obama</span></span>
<span><span class="va">sotu_meta</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Obama"</span>, <span class="va">president</span>, ignore.case <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"2009"</span>, <span class="va">years_active</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt;     X    president year years_active      party sotu_type</span></span>
<span><span class="co">#&gt; 1 229 Barack Obama 2009    2009-2013 Democratic    speech</span></span>
<span><span class="co">#&gt; 2 230 Barack Obama 2010    2009-2013 Democratic    speech</span></span>
<span><span class="co">#&gt; 3 231 Barack Obama 2011    2009-2013 Democratic    speech</span></span>
<span><span class="co">#&gt; 4 232 Barack Obama 2012    2009-2013 Democratic    speech</span></span>
<span></span>
<span><span class="co"># Picking this speech of his first year</span></span>
<span><span class="va">text_sotu</span> <span class="op">&lt;-</span> <span class="va">sotu_text</span><span class="op">[</span><span class="fl">229</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span> <span class="co"># turning the vector into a single element</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">text_sotu</span><span class="op">)</span> <span class="co"># first lines of the text</span></span>
<span><span class="co">#&gt;  chr "Madam Speaker, Mr. Vice President, Members of Congress, the First Lady of the United States--she's around here "| __truncated__</span></span>
<span></span>
<span><span class="co"># As a matter of curiosity, checking the most frequent entities</span></span>
<span><span class="va">text_sotu</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/extract_entity.html">extract_entity</a></span><span class="op">(</span>sw <span class="op">=</span> <span class="va">my_sw</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/count.html" class="external-link">count</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">#&gt;                           x freq</span></span>
<span><span class="co">#&gt; 1                  American   25</span></span>
<span><span class="co">#&gt; 2                   America   16</span></span>
<span><span class="co">#&gt; 3                 Americans   14</span></span>
<span><span class="co">#&gt; 4                       Now   13</span></span>
<span><span class="co">#&gt; 5                  Congress    9</span></span>
<span><span class="co">#&gt; 6                    Nation    6</span></span>
<span><span class="co">#&gt; 7                   Chamber    5</span></span>
<span><span class="co">#&gt; 8                Government    4</span></span>
<span><span class="co">#&gt; 9                      Iraq    4</span></span>
<span><span class="co">#&gt; 10                Democrats    3</span></span>
<span><span class="co">#&gt; 11                 Medicare    3</span></span>
<span><span class="co">#&gt; 12                President    3</span></span>
<span><span class="co">#&gt; 13              Republicans    3</span></span>
<span><span class="co">#&gt; 14 United States of America    3</span></span>
<span><span class="co">#&gt; 15              Afghanistan    2</span></span>
<span><span class="co">#&gt; 16                  Already    2</span></span>
<span><span class="co">#&gt; 17                    Given    2</span></span>
<span><span class="co">#&gt; 18                      God    2</span></span>
<span><span class="co">#&gt; 19                 Laughter    2</span></span>
<span><span class="co">#&gt; 20          Social Security    2</span></span>
<span><span class="co">#&gt; 21                    Thank    2</span></span>
<span><span class="co">#&gt; 22              Wall Street    2</span></span>
<span><span class="co">#&gt; 23                     Well    2</span></span>
<span><span class="co">#&gt; 24                 Al Qaida    1</span></span>
<span><span class="co">#&gt; 25                    Along    1</span></span>
<span><span class="co">#&gt; 26        American Recovery    1</span></span>
<span><span class="co">#&gt; 27                    April    1</span></span>
<span><span class="co">#&gt; 28                  Cabinet    1</span></span>
<span><span class="co">#&gt; 29                     CEOs    1</span></span>
<span><span class="co">#&gt; 30                    China    1</span></span>
<span></span>
<span><span class="va">sotu_g_Ob</span> <span class="op">&lt;-</span> <span class="va">text_sotu</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/extract_graph.html">extract_graph</a></span><span class="op">(</span>sw <span class="op">=</span> <span class="va">my_sw</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tokenizing by sentences</span></span>
<span></span>
<span><span class="va">count_graph_ob</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sotu_g_Ob</span>,</span>
<span>  <span class="va">n1</span>, <span class="va">n2</span>,</span>
<span>  sort <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">count_graph_ob</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5,307 × 3</span></span></span>
<span><span class="co">#&gt;    n1        n2            n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> American  America     219</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Now       American    193</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> America   American    181</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> American  Americans   176</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Americans American    174</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Congress  American    146</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> American  Now         132</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Now       America     131</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Americans America     116</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Now       Americans   110</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5,297 more rows</span></span></span></code></pre></div>
<p>To plot we’ll use another function, plot_graph2. It works differently
than net_wordcloud. Because word frequencies can vary significantly,
differences in text size can be substantial. Therefore, instead of
adjusting text size, we vary the dot/node size, ensuring the text
remains consistently sized and maintains readability.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_graph2.html">plot_graph2</a></span><span class="op">(</span></span>
<span>  <span class="va">sotu_g_Ob</span>,</span>
<span>  <span class="va">count_graph_ob</span>,</span>
<span>  head_n <span class="op">=</span> <span class="fl">70</span>,</span>
<span>  edge_color <span class="op">=</span> <span class="st">"blue"</span>, edge_alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  text_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  scale_graph <span class="op">=</span> <span class="st">"log2"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Obama SOTU - First Year"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in ggraph::geom_node_point(ggplot2::aes(size =</span></span>
<span><span class="co">#&gt; eval(dplyr::sym(scale_graph))(freqPPN$freq)), : Ignoring unknown</span></span>
<span><span class="co">#&gt; parameters: `repel`</span></span></code></pre></div>
<p><img src="entities_and_relation_extraction_files/figure-html/plot-1.png" width="750"></p>
<p>Checking Trump speech of the first year of his first mandate</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Trump, first Mandate</span></span>
<span><span class="va">sotu_meta</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Trump"</span>, <span class="va">president</span>, ignore.case <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     X    president year years_active      party sotu_type</span></span>
<span><span class="co">#&gt; 1 237 Donald Trump 2017    2016-2020 Republican    speech</span></span>
<span><span class="co">#&gt; 2 238 Donald Trump 2018    2016-2020 Republican    speech</span></span>
<span><span class="co">#&gt; 3 239 Donald Trump 2019    2016-2020 Republican    speech</span></span>
<span><span class="co">#&gt; 4 240 Donald Trump 2020    2016-2020 Republican    speech</span></span>
<span></span>
<span><span class="va">sotu_g_Tr</span> <span class="op">&lt;-</span> <span class="va">sotu_text</span><span class="op">[</span><span class="fl">237</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/extract_graph.html">extract_graph</a></span><span class="op">(</span>sw <span class="op">=</span> <span class="va">my_sw</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tokenizing by sentences</span></span>
<span></span>
<span><span class="co">#  the most frequent entities</span></span>
<span><span class="va">sotu_g_Tr</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/extract_entity.html">extract_entity</a></span><span class="op">(</span>sw <span class="op">=</span> <span class="va">my_sw</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/count.html" class="external-link">count</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in stri_extract_all_regex(string, pattern, simplify = simplify, :</span></span>
<span><span class="co">#&gt; argument is not an atomic vector; coercing</span></span>
<span><span class="co">#&gt;                        x freq</span></span>
<span><span class="co">#&gt; 1               American 9019</span></span>
<span><span class="co">#&gt; 2                America 8736</span></span>
<span><span class="co">#&gt; 3              Americans 4875</span></span>
<span><span class="co">#&gt; 4                 Nation 3619</span></span>
<span><span class="co">#&gt; 5          United States 2979</span></span>
<span><span class="co">#&gt; 6                  Thank 2331</span></span>
<span><span class="co">#&gt; 7               Congress 2004</span></span>
<span><span class="co">#&gt; 8                  Megan 2004</span></span>
<span><span class="co">#&gt; 9                   Ryan 2004</span></span>
<span><span class="co">#&gt; 10            Government 1675</span></span>
<span><span class="co">#&gt; 11             Obamacare 1675</span></span>
<span><span class="co">#&gt; 12              Laughter 1344</span></span>
<span><span class="co">#&gt; 13             Democrats 1011</span></span>
<span><span class="co">#&gt; 14               Finally 1011</span></span>
<span><span class="co">#&gt; 15                   God 1011</span></span>
<span><span class="co">#&gt; 16                 Jenna 1011</span></span>
<span><span class="co">#&gt; 17           Republicans 1011</span></span>
<span><span class="co">#&gt; 18                 Today 1011</span></span>
<span><span class="co">#&gt; 19               Tonight 1011</span></span>
<span><span class="co">#&gt; 20             According  676</span></span>
<span><span class="co">#&gt; 21              Applause  676</span></span>
<span><span class="co">#&gt; 22                Canada  676</span></span>
<span><span class="co">#&gt; 23               Denisha  676</span></span>
<span><span class="co">#&gt; 24 Department of Justice  676</span></span>
<span><span class="co">#&gt; 25                Jamiel  676</span></span>
<span><span class="co">#&gt; 26           Jamiel Shaw  676</span></span>
<span><span class="co">#&gt; 27         Jessica Davis  676</span></span>
<span><span class="co">#&gt; 28                Jewish  676</span></span>
<span><span class="co">#&gt; 29               Joining  676</span></span>
<span><span class="co">#&gt; 30               Justice  676</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_graph2.html">plot_graph2</a></span><span class="op">(</span></span>
<span>  <span class="va">sotu_g_Tr</span>,</span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sotu_g_Tr</span>, <span class="va">n1</span>, <span class="va">n2</span>, sort <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  head_n <span class="op">=</span> <span class="fl">70</span>,</span>
<span>  edge_color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  edge_alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  scale_graph <span class="op">=</span> <span class="st">"log2"</span>,</span>
<span>  text_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Trump SOTU - First Year"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in ggraph::geom_node_point(ggplot2::aes(size =</span></span>
<span><span class="co">#&gt; eval(dplyr::sym(scale_graph))(freqPPN$freq)), : Ignoring unknown</span></span>
<span><span class="co">#&gt; parameters: `repel`</span></span></code></pre></div>
<p><img src="entities_and_relation_extraction_files/figure-html/sotu%20Trump-1.png" width="750"></p>
<p>Now, comparing speeches on a certain topic</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a regex to capture some words/patterns</span></span>
<span><span class="va">term</span> <span class="op">&lt;-</span> <span class="st">"\\bChin|Beijing|Shanghai|\\bXi\\b|Jinping"</span></span>
<span><span class="va">term_</span> <span class="op">&lt;-</span> <span class="st">"China"</span></span>
<span></span>
<span><span class="co"># Get all Obama speeches of his first mandate</span></span>
<span><span class="va">text_sotu_Ob</span> <span class="op">&lt;-</span> <span class="va">sotu_text</span><span class="op">[</span><span class="fl">229</span><span class="op">:</span><span class="fl">234</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filter_by_query.html">filter_by_query</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sotu_g_Ob</span> <span class="op">&lt;-</span> <span class="va">text_sotu_Ob</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/extract_graph.html">extract_graph</a></span><span class="op">(</span>sw <span class="op">=</span> <span class="va">my_sw</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tokenizing by sentences</span></span>
<span></span>
<span><span class="va">g_Ob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_graph2.html">plot_graph2</a></span><span class="op">(</span></span>
<span>  <span class="va">sotu_g_Ob</span>,</span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sotu_g_Ob</span>, <span class="va">n1</span>, <span class="va">n2</span>, sort <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  edge_color <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>  edge_alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  text_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  scale_graph <span class="op">=</span> <span class="st">"log2"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># ggplot2::labs(title= paste("Obama about", term))</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Obama"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in ggraph::geom_node_point(ggplot2::aes(size =</span></span>
<span><span class="co">#&gt; eval(dplyr::sym(scale_graph))(freqPPN$freq)), : Ignoring unknown</span></span>
<span><span class="co">#&gt; parameters: `repel`</span></span>
<span></span>
<span></span>
<span><span class="co"># Trump</span></span>
<span><span class="va">text_sotu_Tr</span> <span class="op">&lt;-</span> <span class="va">sotu_text</span><span class="op">[</span><span class="fl">237</span><span class="op">:</span><span class="fl">240</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filter_by_query.html">filter_by_query</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sotu_g_Tr</span> <span class="op">&lt;-</span> <span class="va">text_sotu_Tr</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/extract_graph.html">extract_graph</a></span><span class="op">(</span>sw <span class="op">=</span> <span class="va">my_sw</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tokenizing by sentences</span></span>
<span></span>
<span><span class="va">g_Tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_graph2.html">plot_graph2</a></span><span class="op">(</span></span>
<span>  <span class="va">sotu_g_Tr</span>,</span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sotu_g_Tr</span>, <span class="va">n1</span>, <span class="va">n2</span>, sort <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  edge_color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  edge_alpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  text_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  scale_graph <span class="op">=</span> <span class="st">"log2"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># ggplot2::labs(title= paste("Trump about", term))</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Trump"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in ggraph::geom_node_point(ggplot2::aes(size =</span></span>
<span><span class="co">#&gt; eval(dplyr::sym(scale_graph))(freqPPN$freq)), : Ignoring unknown</span></span>
<span><span class="co">#&gt; parameters: `repel`</span></span>
<span></span>
<span><span class="co"># Joining the graphs</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">g_Ob</span> <span class="op">+</span> <span class="va">g_Tr</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span></span>
<span>      <span class="st">"Coocurrence of terms related to China"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="entities_and_relation_extraction_files/figure-html/sotu%20obama%20trump%20graph-1.png" width="750"></p>
</div>
<div class="section level2">
<h2 id="substitutions-replacing-node-text">Substitutions: replacing node text<a class="anchor" aria-label="anchor" href="#substitutions-replacing-node-text"></a>
</h2>
<p>When extracting graphs from unstructured text, some synonyms will
appear. To replace the text of nodes in dataframe, use the function
graph_subs:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a test tibble</span></span>
<span><span class="va">test_graph</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"Ab"</span>, <span class="st">"A"</span>, <span class="st">"D"</span><span class="op">)</span>,</span>
<span>  n2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"Ab"</span>, <span class="st">"B"</span>, <span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span> <span class="co"># Includes a loop (D-D)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># dataframe with substitutions</span></span>
<span><span class="va">DF_substitution</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">col1</span>, <span class="op">~</span><span class="va">col2</span>,</span>
<span>  <span class="st">"B"</span>, <span class="st">"blah"</span>,</span>
<span>  <span class="st">"C"</span>, <span class="st">"Capybara"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Doing the substitutions</span></span>
<span><span class="va">test_graph</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/graph_subs.html">graph_subs</a></span><span class="op">(</span><span class="va">DF_substitution</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 2</span></span></span>
<span><span class="co">#&gt;   n1       n2      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A        blah    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> blah     Ab      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> A        blah    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Capybara D       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> blah     Capybara</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Ab       A       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> A        Capybara</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> D        D</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="final-remarks">Final remarks<a class="anchor" aria-label="anchor" href="#final-remarks"></a>
</h2>
<p>As mentioned, this approach based on text patterns (regex) has its
limitations. We advise to test different head_n, to increase the number
of nodes, and if it is too polluted, decrease it. It can helps to see
what to look at the text to infer meaning. Is possible to use grammar
classification to get more precise results. See next session, “Extract
entity co occurrences with POS”.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alisson Soares.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
